<% 	// This script provides option for calling xslt transformer	// MK 20/10/2005		C_text($type;$recNum;$catNumber)		$type:= _query{"type"}	$recnum:= _query{"recnum"}	$catNumber:= _query{"catNumber"}		write to console ('Call xslt Loader type = $type recnum = $recnum catNumber = $catNumber')	C_Blob($xlst_Stylesheet;$entryblob)		case of 			:($type # "")							case of					:($type="catalogue")						read only(*)						goto record([Catalogue];num($recnum))						if ($catNumber = "") // Must be direct click from Show Catalogues so just show first one!								$catNumber := A4D__xmlFirstmsDescriptionCatNo(num($recnum)) // return number of first catalogue						end if												write to console ('Final Catnumber = $catNumber')						C_text($baseDir)						$baseDir := url to native path(join paths(get root ; "xslt"))												C_Blob($theBlob)												$theBlob := [Catalogue]XMLBlob						$fullPath := join paths(get root ; "xslt"; "select_cat.xsl") // NB * to return native path which is required with document to Blob command						if (Test path name($fullPath)=Is a document)							document to blob($fullPath;$xlst_Stylesheet)							$entryblob := XSLT_Transformer($theBlob; $xlst_Stylesheet; $baseDir; "catalogueNumber"; $catNumber) // get first catalogue on load						end if												write blob($entryblob; "text/html")											:($type="bibliography")									end case			end case %> 